---
title: "Regression"
author: ""
date: "2024-04-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(dynlm)
library(lmtest)
library(dplyr)
data <- read_excel("Makroøkonomisk projekt.xlsx")
gdp <- data$gdp_pct_change; china <- data$`China: Real GDP growth quarterly previous period (National Bureau of Statistics of China)`; unemp <- data$unemp; exp <- data$`Real Exports of Goods and Services for Germany, Percent Change, Quarterly, Seasonally Adjusted`
inf <- data$`HPI: growth same period previous year`; rente <- data$`Interest Rate (10-year Goverment Bond Yields)`; pri_con <- data$`Real private consumption: https://fred.stlouisfed.org/series/NAEXKP02DEQ657S`; gov_con <- data$`Germany Fiscal Expenditure EUR Billion.`; energy <- data$`Consumer Price Index: OECD Groups: Energy (Fuel, Electricity, and Gasoline): Total for Germany, Change, Growth rate same period previous year, Quarterly, Not Seasonally Adjusted`; gdp_yearago<-data$`Real GDP percent year ago`; eurozone<-data$`Eurozonen: Real GDP growth quarterly previous period`
fx<- gsub('"', '', data$`exchange rate 1 EUR to USD`)
fx
View(data)
```

Regressionsmodel for BNP
```{r}
mod <- lm(gdp_yearago~Export_pct_change_year_ago+inf+energy+rente+eurozone+unemp+fx)
summary(mod)
plot(mod, which=1)
hist(residuals(mod))
bptest(mod)
```
```{r}
plot(gdp, ylim=c(-15,15), type="l", col="blue")
lines(exp, type="l", col="red")
lines(100*gov_con_log[1:96], type="l", col="black")
lines(energy, type="l", col="green")
energy <- na.omit(energy)
```
Procentvis ændring for gov exp
```{r}
gov_con_log <- c(NA, diff(gov_con)/lag(gov_con))
gov_con_log <- gov_con_log[2:97]
```



Regressionsmodel for export
```{r}
reg_exp <- lm(exp[1:90] ~ china[1:90] + lag(energy[1:90], 2))
summary(reg_exp)
```


```{r}
 # Libraries for dynamic lm, regression table and F tests
library(dynlm);library(lmtest);library(car)
data(data, package=’wooldridge’)# Define Yearly time series beginning in 1913
tsdata <- ts(fertil3, start=1913) # Linear regression of model with lags:
res <- dynlm(gfr ~ pe + L(pe) + L(pe,2) + ww2 + pill, data=tsdata)
coeftest(res)
```





